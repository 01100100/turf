VERSION 4.00
Begin VB.Form classer 
   Appearance      =   0  'Flat
   BackColor       =   &H00808000&
   Caption         =   "Classing"
   ClientHeight    =   6330
   ClientLeft      =   1170
   ClientTop       =   2190
   ClientWidth     =   7635
   BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
      Name            =   "MS Sans Serif"
      Size            =   8.25
      Charset         =   0
      Weight          =   700
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H80000008&
   Height          =   6735
   Left            =   1110
   LinkTopic       =   "Form1"
   MousePointer    =   1  'Arrow
   ScaleHeight     =   6330
   ScaleWidth      =   7635
   Top             =   1845
   Width           =   7755
   Begin VB.TextBox Text2 
      Appearance      =   0  'Flat
      BackColor       =   &H0080FF80&
      Height          =   375
      Left            =   3960
      TabIndex        =   6
      Top             =   4800
      Width           =   2055
   End
   Begin VB.ListBox List2 
      Appearance      =   0  'Flat
      BackColor       =   &H0080FF80&
      Height          =   1200
      Left            =   4560
      TabIndex        =   4
      Top             =   2520
      Width           =   2055
   End
   Begin VB.CommandButton ok 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      Caption         =   "OK"
      Height          =   495
      Left            =   3120
      TabIndex        =   3
      Top             =   5520
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Flat
      BackColor       =   &H0080FF80&
      Height          =   375
      Left            =   2760
      TabIndex        =   1
      Top             =   4800
      Width           =   615
   End
   Begin VB.ListBox List1 
      Appearance      =   0  'Flat
      BackColor       =   &H0080FF80&
      ForeColor       =   &H00000000&
      Height          =   1200
      Left            =   4920
      TabIndex        =   0
      Top             =   360
      Width           =   735
   End
   Begin VB.Label Label3 
      Appearance      =   0  'Flat
      BackColor       =   &H00808000&
      Caption         =   "Selection:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Left            =   1080
      TabIndex        =   7
      Top             =   4800
      Width           =   1095
   End
   Begin VB.Label Label2 
      Appearance      =   0  'Flat
      BackColor       =   &H00808000&
      Caption         =   "Choose the classing method:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Left            =   720
      TabIndex        =   5
      Top             =   2520
      Width           =   3135
   End
   Begin VB.Label Label1 
      Appearance      =   0  'Flat
      BackColor       =   &H00808000&
      Caption         =   "Choose the number of classes:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Times New Roman"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Left            =   720
      TabIndex        =   2
      Top             =   360
      Width           =   3255
   End
End
Attribute VB_Name = "classer"
Attribute VB_Creatable = False
Attribute VB_Exposed = False
Private Sub Form_Load()

List2.Enabled = False
ok.Enabled = False
For i = 1 To numclass
    lowclass(i) = 0: highclass(i) = 0
Next

End Sub

Private Sub List1_Click()

Text1.Text = List1.ListIndex + 1
numclass = List1.ListIndex + 1
ReDim lowclass(numclass), highclass(numclass), nclass(numclass)
List2.Enabled = True

End Sub

Private Sub List2_Click()

Text2.Text = List2
kind = List2.ListIndex + 1
classkind$ = Text2.Text
If kind = 5 Then
    user.Show
    user.Label2.Caption = Str$(numclass)
    user.Text1.Text = ""
    user.Text2.Text = ""

    For i = 1 To numclass
        user.List1.AddItem Str$(i)
        lowclass(i) = 0
        highclass(i) = 0
    Next
End If

If kind > 0 And numclass > 0 Then ok.Enabled = True

End Sub

Private Sub ok_Click()

On kind GoTo 100, 200, 300, 400, 500

100 'equal interval***********************

Interval = (maxvalue - minvalue) / numclass

For i = 1 To numclass
    lowclass(i) = minvalue + (Interval * (i - 1))
    If i > 1 Then lowclass(i) = lowclass(i) + adder
    highclass(i) = minvalue + (Interval * i)
Next
GoTo 600

200 'quantiles****************************

Interval = Int(n / numclass)
dif = n - (Interval * numclass)
ncount = 1
For i = 1 To numclass
    lowval = ncount
    highval = ncount + Interval - 1
    If dif > 0 Then highval = highval + 1
    dif = dif - 1
    ncount = highval + 1
    lowclass(i) = value(lowval)
    highclass(i) = value(highval)
Next
GoTo 600

300 'standard deviation*******************

n4! = numclass
lowest = mean - (sd * (n4! / 2))

For i = 1 To numclass
    lowclass(i) = lowest + (sd * (i - 1))
    highclass(i) = lowclass(i) + sd
    If i > 1 Then lowclass(i) = lowclass(i) + adder
Next
For i = 1 To n
    If value(i) > highclass(numclass) Then highclass(numclass) = value(i)
    If value(i) < lowclass(1) Then lowclass(1) = value(1)
Next
GoTo 600

400 'minimum variance*********************

Screen.MousePointer = 11
ReDim m1(n, numclass), a1(n, numclass)

For i = 1 To numclass
    a1(1, i) = 0
    m1(1, i) = 1
    For j = 2 To n
        a1(j, i) = 999999999999999#
    Next
Next

For i = 2 To n
    s1 = 0: s2 = 0: k1 = 0
    For j = 1 To i
        i3 = i - j + 1
        s2 = s2 + value(i3) ^ 2
        s1 = s1 + value(i3)
        k1 = k1 + 1
        v = s2 - s1 ^ 2 / k1
        i4 = i3 - 1
        If i4 = 0 Then GoTo 1520
        For k = 1 To numclass
            If k = 1 Then GoTo 1510
            If a1(i, k) < v + a1(i4, k - 1) Then GoTo 1510
            m1(i, k) = i3
            a1(i, k) = v + a1(i4, k - 1)
1510    Next
1520 Next
    m1(i, 1) = 1
    a1(i, 1) = v
Next
i5 = n + 1
For j = 1 To numclass
    l2 = numclass - j + 1
    i6 = i5 - 1
    i5 = m1(i6, l2)
    lowclass(l2) = value(i5)
    highclass(l2) = value(i6)
Next
Screen.MousePointer = 1
GoTo 600

500 'user -defined************************

user.Hide

600 'assign classes***********************

For i = 1 To n
    For j = 1 To numclass
        If value(i) >= lowclass(j) And value(i) <= highclass(j) Then cl(i) = j
        If value(i) >= lowclass(j) And value(i) <= highclass(j) Then nclass(j) = nclass(j) + 1
    Next

Next
    
    'report classing results**************

classer.Hide
reporter.List1.Clear
reporter.List2.Clear
reporter.List3.Clear
reporter.List4.Clear
reporter.List5.Clear

reporter.Show
reporter.Label1.Caption = dataname$
reporter.Label2.Caption = Text2.Text

For i = 1 To n
    reporter.List1.AddItem nam$(i) + Str$(cl(i))
Next


For i = 1 To numclass
    reporter.List2.AddItem Str$(i)
    reporter.List3.AddItem Str$(lowclass(i))
    reporter.List4.AddItem Str$(highclass(i))
    reporter.List5.AddItem Str$(nclass(i))
Next

End Sub

